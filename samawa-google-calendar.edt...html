<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAMAWA - BPS Kabupaten Sumbawa</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Sora:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-orange: #FF6B35;
            --orange-light: #FF8C61;
            --orange-dark: #E85A2A;
            --accent-yellow: #FFB627;
            --bg-cream: #FFF8F3;
            --bg-white: #FFFFFF;
            --text-dark: #1A1A1A;
            --text-gray: #6B7280;
            --text-light: #9CA3AF;
            --border: #F3E8E1;
            --sidebar-width: 300px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            color: var(--text-dark);
            background: var(--bg-cream);
            overflow-x: hidden;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: var(--sidebar-width);
            height: 100vh;
            background: white;
            border-right: 1px solid var(--border);
            z-index: 1000;
            overflow-y: auto;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.03);
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--primary-orange);
        }

        /* Logo */
        .sidebar-logo {
            padding: 25px 20px;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            background: white;
            z-index: 10;
        }

        .logo-content {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .logo-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-dark));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-title {
            font-family: 'Sora', sans-serif;
            font-size: 20px;
            font-weight: 700;
            color: var(--primary-orange);
            line-height: 1;
        }

        .logo-subtitle {
            font-size: 10px;
            color: var(--text-gray);
            margin-top: 3px;
        }

        /* Menu */
        .sidebar-menu {
            padding: 15px 0;
        }

        .menu-section {
            margin-bottom: 8px;
        }

        .menu-label {
            padding: 8px 20px;
            font-size: 11px;
            font-weight: 700;
            color: var(--text-gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .menu-item {
            margin: 2px 12px;
        }

        .menu-link {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            color: var(--text-dark);
            text-decoration: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
            user-select: none;
        }

        .menu-link:hover {
            background: var(--bg-cream);
            color: var(--primary-orange);
        }

        .menu-link.active {
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-dark));
            color: white;
            box-shadow: 0 3px 12px rgba(255, 107, 53, 0.3);
        }

        .menu-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .menu-text {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .menu-arrow {
            font-size: 10px;
            transition: transform 0.3s;
            flex-shrink: 0;
        }

        .menu-link.open .menu-arrow {
            transform: rotate(180deg);
        }

        /* Submenu */
        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .submenu.open {
            max-height: 2000px;
        }

        .submenu-item {
            margin: 2px 0;
        }

        .submenu-link {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px 8px 42px;
            color: var(--text-gray);
            text-decoration: none;
            font-size: 12px;
            font-weight: 500;
            border-radius: 6px;
            transition: all 0.2s;
            cursor: pointer;
            user-select: none;
        }

        .submenu-link:hover {
            background: var(--bg-cream);
            color: var(--primary-orange);
        }

        .submenu-link.active {
            background: var(--bg-cream);
            color: var(--primary-orange);
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            min-height: 100vh;
        }

        /* Header */
        .top-header {
            background: white;
            border-bottom: 1px solid var(--border);
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
        }

        .header-title {
            font-family: 'Sora', sans-serif;
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-orange), var(--accent-yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn-header {
            background: white;
            border: 1px solid var(--border);
            padding: 10px 18px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-header:hover {
            border-color: var(--primary-orange);
            color: var(--primary-orange);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-dark));
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }

        /* Content Area */
        .content-area {
            padding: 40px;
        }

        /* Page Content */
        .page-content {
            display: none;
        }

        .page-content.active {
            display: block;
        }

        /* Breadcrumb */
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 25px;
            font-size: 13px;
            color: var(--text-gray);
        }

        .breadcrumb a {
            color: var(--primary-orange);
            text-decoration: none;
            font-weight: 500;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: var(--text-light);
        }

        /* Content Card */
        .content-card {
            background: white;
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 25px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
        }

        .content-header {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--bg-cream);
        }

        .content-title {
            font-family: 'Sora', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .content-description {
            font-size: 15px;
            color: var(--text-gray);
            line-height: 1.7;
        }

        /* Document List */
        .document-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .document-item {
            background: var(--bg-cream);
            border-radius: 12px;
            padding: 20px;
            border: 2px solid var(--border);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .document-item:hover {
            transform: translateY(-4px);
            border-color: var(--primary-orange);
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.15);
        }

        .document-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-light));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .document-name {
            font-weight: 600;
            font-size: 15px;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .document-meta {
            font-size: 12px;
            color: var(--text-gray);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Calendar Section */
        .calendar-section {
            background: white;
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .section-title {
            font-family: 'Sora', sans-serif;
            font-size: 24px;
            font-weight: 700;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .title-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-light));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        /* Calendar Grid */
        .calendar-container {
            display: grid;
            gap: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-month {
            font-family: 'Sora', sans-serif;
            font-size: 20px;
            font-weight: 700;
            color: var(--text-dark);
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .btn-nav {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-size: 16px;
        }

        .btn-nav:hover {
            background: var(--primary-orange);
            color: white;
            border-color: var(--primary-orange);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .calendar-day-header {
            text-align: center;
            font-weight: 700;
            font-size: 12px;
            color: var(--text-gray);
            padding: 10px;
            text-transform: uppercase;
        }

        .calendar-day {
            aspect-ratio: 1;
            border-radius: 10px;
            border: 1px solid var(--border);
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            background: white;
            display: flex;
            flex-direction: column;
        }

        .calendar-day:hover {
            border-color: var(--primary-orange);
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.15);
            transform: translateY(-2px);
        }

        .calendar-day.other-month {
            opacity: 0.3;
        }

        .calendar-day.today {
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-dark));
            color: white;
            border-color: var(--primary-orange);
        }

        .calendar-day.has-event {
            background: var(--bg-cream);
            border-color: var(--primary-orange);
        }

        .day-number {
            font-weight: 700;
            font-size: 15px;
            margin-bottom: 5px;
        }

        .day-event {
            font-size: 10px;
            background: var(--primary-orange);
            color: white;
            padding: 3px 6px;
            border-radius: 4px;
            margin-top: auto;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .calendar-day.today .day-event {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Grid Layout */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }

        /* Employee of the Month */
        .eom-card {
            background: linear-gradient(135deg, #FFF 0%, var(--bg-cream) 100%);
            border-radius: 20px;
            padding: 35px;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .eom-card::before {
            content: '';
            position: absolute;
            top: -30%;
            right: -20%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(255, 107, 53, 0.1) 0%, transparent 70%);
            border-radius: 50%;
        }

        .eom-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .eom-photo {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-dark));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 56px;
            font-weight: 700;
            box-shadow: 0 15px 35px rgba(255, 107, 53, 0.3);
            position: relative;
            margin-bottom: 20px;
        }

        .eom-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 50px;
            height: 50px;
            background: var(--accent-yellow);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 4px 15px rgba(255, 182, 39, 0.4);
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .eom-info h3 {
            font-family: 'Sora', sans-serif;
            font-size: 20px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .eom-label {
            display: inline-block;
            background: var(--primary-orange);
            color: white;
            padding: 5px 14px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .eom-description {
            font-size: 14px;
            line-height: 1.7;
            color: var(--text-gray);
        }

        /* Quick Access */
        .quick-access {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .access-card {
            background: white;
            border-radius: 14px;
            padding: 25px;
            border: 1px solid var(--border);
            transition: all 0.3s;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
            display: block;
        }

        .access-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.15);
            border-color: var(--primary-orange);
        }

        .access-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-light));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.25);
        }

        .access-title {
            font-family: 'Sora', sans-serif;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 6px;
        }

        .access-description {
            font-size: 13px;
            color: var(--text-gray);
            line-height: 1.5;
        }

        /* Mobile Menu Button */
        .mobile-menu-btn {
            display: none;
            width: 40px;
            height: 40px;
            border: 1px solid var(--border);
            background: white;
            border-radius: 8px;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .content-area {
                padding: 20px;
            }

            .mobile-menu-btn {
                display: flex;
            }

            .header-actions {
                gap: 10px;
            }

            .btn-header span {
                display: none;
            }

            .calendar-grid {
                gap: 5px;
            }

            .calendar-day {
                padding: 6px;
            }

            .document-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeInUp 0.5s ease-out forwards;
        }

        /* Divider */
        .menu-divider {
            height: 1px;
            background: var(--border);
            margin: 8px 20px;
        }

        /* Stats Cards Mini */
        .stat-card-mini {
            background: var(--bg-cream);
            padding: 20px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .stat-icon-mini {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-dark));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .stat-content-mini h3 {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
        }

        .stat-content-mini p {
            font-size: 13px;
            color: var(--text-gray);
            margin: 4px 0 0 0;
        }

        /* Calendar Days Grid */
        .calendar-days-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0;
        }

        .calendar-days-grid .calendar-day {
            min-height: 100px;
            border-right: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
            padding: 12px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .calendar-days-grid .calendar-day:nth-child(7n) {
            border-right: none;
        }

        .calendar-days-grid .calendar-day:hover:not(.other-month) {
            background: var(--bg-cream);
            transform: scale(1.02);
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .calendar-days-grid .calendar-day.other-month {
            background: #fafafa;
            opacity: 0.4;
            pointer-events: none;
        }

        .calendar-days-grid .calendar-day.today {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 107, 53, 0.05));
            border: 2px solid var(--primary-orange) !important;
        }

        .calendar-days-grid .calendar-day.has-event:not(.other-month) {
            background: linear-gradient(to bottom, white 0%, var(--bg-cream) 100%);
        }

        .calendar-day .day-number {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-dark);
        }

        .calendar-days-grid .calendar-day.today .day-number {
            color: var(--primary-orange);
            font-size: 22px;
        }

        .calendar-day .day-event {
            font-size: 11px;
            color: var(--text-gray);
            margin-top: auto;
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 6px 8px;
            background: white;
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        .day-events-container {
            display: flex;
            flex-direction: column;
            gap: 4px;
            margin-top: 8px;
            flex: 1;
        }

        .event-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            color: white;
            opacity: 0.9;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .day-event-count {
            font-size: 10px;
            color: var(--text-gray);
            margin-top: auto;
            text-align: center;
            padding: 4px;
            background: white;
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        .event-indicator {
            width: 6px;
            height: 6px;
            background: var(--primary-orange);
            border-radius: 50%;
            display: inline-block;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Modal Calendar */
        .modal-calendar {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .modal-calendar.active {
            display: flex;
        }

        .modal-content-calendar {
            background: white;
            border-radius: 20px;
            padding: 35px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header-calendar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title-calendar {
            font-family: 'Sora', sans-serif;
            font-size: 24px;
            font-weight: 700;
            color: var(--text-dark);
        }

        .close-btn-calendar {
            width: 35px;
            height: 35px;
            border-radius: 10px;
            border: none;
            background: var(--bg-cream);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s;
        }

        .close-btn-calendar:hover {
            background: var(--primary-orange);
            color: white;
        }

        .form-group-calendar {
            margin-bottom: 20px;
        }

        .form-label-calendar {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-dark);
            font-size: 14px;
        }

        .form-control-calendar {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 14px;
            font-family: 'Plus Jakarta Sans', sans-serif;
            transition: all 0.3s;
        }

        .form-control-calendar:focus {
            outline: none;
            border-color: var(--primary-orange);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        select.form-control-calendar {
            cursor: pointer;
        }

        .form-row-calendar {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .modal-footer-calendar {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 25px;
        }

        .btn-secondary-calendar {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            border: 2px solid var(--primary-orange);
            background: white;
            color: var(--primary-orange);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .btn-secondary-calendar:hover {
            background: var(--bg-cream);
        }

        .btn-primary-calendar {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            border: none;
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-dark));
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .btn-primary-calendar:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }

        .file-upload-calendar {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            display: block;
        }

        .file-upload-calendar:hover {
            border-color: var(--primary-orange);
            background: var(--bg-cream);
        }

        .file-upload-icon-calendar {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .file-upload-text-calendar {
            font-size: 14px;
            color: var(--text-gray);
        }

        .file-upload-hint-calendar {
            font-size: 12px;
            color: var(--text-gray);
            margin-top: 8px;
        }

        /* Embedded Spreadsheet */
        .embedded-sheet-container {
            background: white;
            border-radius: 20px;
            padding: 0;
            margin-bottom: 30px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
            overflow: hidden;
        }

        .embedded-sheet-header {
            padding: 25px 35px;
            border-bottom: 2px solid var(--bg-cream);
            background: linear-gradient(135deg, #FFF 0%, var(--bg-cream) 100%);
        }

        .embedded-sheet-title {
            font-family: 'Sora', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .embedded-sheet-description {
            font-size: 15px;
            color: var(--text-gray);
            line-height: 1.7;
        }

        .embedded-sheet-actions {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }

        .btn-sheet {
            background: white;
            border: 2px solid var(--primary-orange);
            color: var(--primary-orange);
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-sheet:hover {
            background: var(--primary-orange);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.3);
        }

        .btn-sheet.primary {
            background: linear-gradient(135deg, var(--primary-orange), var(--orange-dark));
            color: white;
            border: none;
        }

        .btn-sheet.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
        }

        .sheet-iframe {
            width: 100%;
            height: 700px;
            border: none;
            display: block;
        }

        .sheet-info {
            padding: 20px 35px;
            background: var(--bg-cream);
            font-size: 13px;
            color: var(--text-gray);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sheet-info-icon {
            font-size: 16px;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-logo">
            <a href="#" class="logo-content" onclick="showPage('dashboard')">
                <div class="logo-icon">BPS</div>
                <div class="logo-text">
                    <div class="logo-title">SAMAWA</div>
                    <div class="logo-subtitle">Satu Tempat Lebih Cepat</div>
                </div>
            </a>
        </div>

        <nav class="sidebar-menu">
            <!-- Menu Utama -->
            <div class="menu-section">
                <div class="menu-label">Menu Utama</div>
                <div class="menu-item">
                    <div class="menu-link active" onclick="showPage('dashboard')">
                        <span class="menu-icon">üè†</span>
                        <span class="menu-text">Beranda</span>
                    </div>
                </div>
            </div>

            <!-- Tim Kerja -->
            <div class="menu-section">
                <div class="menu-label">Tim Kerja</div>
                
                <!-- Subbag Umum -->
                <div class="menu-item">
                    <div class="menu-link" onclick="toggleMenu(this)">
                        <span class="menu-icon">üìã</span>
                        <span class="menu-text">Subbag Umum</span>
                        <span class="menu-arrow">‚ñº</span>
                    </div>
                    <div class="submenu">
                        <div class="submenu-item">
                            <div class="submenu-link" onclick="showPage('administrasi')">
                                <span>üìÑ Administrasi</span>
                            </div>
                        </div>
                        <div class="submenu-item">
                            <div class="submenu-link" onclick="showPage('kepegawaian')">
                                <span>üë• Kepegawaian</span>
                            </div>
                        </div>
                        <div class="submenu-item">
                            <div class="submenu-link" onclick="showPage('keuangan')">
                                <span>üí∞ Keuangan</span>
                            </div>
                        </div>
                        <div class="submenu-item">
                            <div class="submenu-link" onclick="showPage('bmn')">
                                <span>üì¶ BMN</span>
                            </div>
                        </div>
                        <div class="submenu-item">
                            <div class="submenu-link" onclick="showPage('anggaran')">
                                <span>üíµ Anggaran</span>
                            </div>
                        </div>
                        <div class="submenu-item">
                            <div class="submenu-link" onclick="showPage('humas')">
                                <span>üì¢ Humas</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Duknaker Kesra -->
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('duknaker-kesra')">
                        <span class="menu-icon">üë∑</span>
                        <span class="menu-text">Duknaker Kesra</span>
                    </div>
                </div>

                <!-- Pertanian -->
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('pertanian')">
                        <span class="menu-icon">üåæ</span>
                        <span class="menu-text">Pertanian</span>
                    </div>
                </div>

                <!-- Ekonomi -->
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('ekonomi')">
                        <span class="menu-icon">üíº</span>
                        <span class="menu-text">Ekonomi</span>
                    </div>
                </div>

                <!-- IPDS -->
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('ipds')">
                        <span class="menu-icon">üíª</span>
                        <span class="menu-text">IPDS</span>
                    </div>
                </div>

                <!-- UKK -->
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('ukk')">
                        <span class="menu-icon">üìä</span>
                        <span class="menu-text">UKK</span>
                    </div>
                </div>

                <!-- Hansos & Analisis -->
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('hansos')">
                        <span class="menu-icon">üîç</span>
                        <span class="menu-text">Hansos & Analisis</span>
                    </div>
                </div>

                <!-- Neraca -->
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('neraca')">
                        <span class="menu-icon">üí∞</span>
                        <span class="menu-text">Neraca</span>
                    </div>
                </div>

                <!-- Harga -->
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('harga')">
                        <span class="menu-icon">üè∑Ô∏è</span>
                        <span class="menu-text">Harga</span>
                    </div>
                </div>

                <div class="menu-item">
                    <div class="menu-link" onclick="toggleMenu(this)">
                        <span class="menu-icon">üìà</span>
                        <span class="menu-text">PSS RB</span>
                        <span class="menu-arrow">‚ñº</span>
                    </div>
                    <div class="submenu">
                        <div class="submenu-item">
                            <a href="https://drive.google.com/drive/folders/1L5BsXG2_w1qW0c9lbgkiCNku7vf8wmNT?usp=sharing" target="_blank" class="submenu-link">
                                <span>üìÅ Rumah Arsip</span>
                            </a>
                        </div>
                        <div class="submenu-item">
                            <div class="submenu-link" onclick="showPage('pss')">
                                <span>üìä PSS</span>
                            </div>
                        </div>
                        <div class="submenu-item">
                            <div class="submenu-link" onclick="showPage('zi')">
                                <span>üèÜ ZI</span>
                            </div>
                        </div>
                        <div class="submenu-item">
                            <div class="submenu-link" onclick="showPage('descan')">
                                <span>üìã Descan</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="menu-divider"></div>

            <!-- Layanan -->
            <div class="menu-section">
                <div class="menu-label">Layanan</div>
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('matriks-perjadin')">
                        <span class="menu-icon">‚úàÔ∏è</span>
                        <span class="menu-text">Matriks Perjadin</span>
                    </div>
                </div>
                <div class="menu-item">
                    <a href="https://drive.google.com/drive/folders/16fJA0z75gSpKwEdcsY9n_ntbHpnmipCk?usp=sharing" target="_blank" class="menu-link">
                        <span class="menu-icon">üì§</span>
                        <span class="menu-text">Upload Kippap Bulanan</span>
                    </a>
                </div>
                <div class="menu-item">
                    <a href="https://amatseno13.github.io/masako/" target="_blank" class="menu-link">
                        <span class="menu-icon">üìä</span>
                        <span class="menu-text">SAKIP</span>
                    </a>
                </div>
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('ruang-inovasi')">
                        <span class="menu-icon">üí°</span>
                        <span class="menu-text">Ruang Inovasi</span>
                    </div>
                </div>
            </div>

            <div class="menu-divider"></div>

            <!-- Lainnya -->
            <div class="menu-section">
                <div class="menu-label">Lainnya</div>
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('pengaturan')">
                        <span class="menu-icon">‚öôÔ∏è</span>
                        <span class="menu-text">Pengaturan</span>
                    </div>
                </div>
                <div class="menu-item">
                    <div class="menu-link" onclick="showPage('bantuan')">
                        <span class="menu-icon">‚ùì</span>
                        <span class="menu-text">Bantuan</span>
                    </div>
                </div>
            </div>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Header -->
        <header class="top-header">
            <button class="mobile-menu-btn" onclick="toggleSidebar()">‚ò∞</button>
            <h1 class="header-title" id="pageTitle">Dashboard</h1>
            <div class="header-actions">
                <button class="btn-header">
                    <span>üîî</span>
                    <span>Notifikasi</span>
                </button>
                <button class="btn-header btn-primary">
                    <span>üë§</span>
                    <span>Profile</span>
                </button>
            </div>
        </header>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page-content active">
                <!-- Calendar Section -->
                <div class="calendar-section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">
                            <span class="title-icon">üìÖ</span>
                            Jadwal Kegiatan
                        </h2>
                        <div style="display: flex; gap: 12px;">
                            <button class="btn-secondary" onclick="openUploadModal()" style="display: flex; align-items: center; gap: 8px; padding: 10px 20px;">
                                <span>üì§</span>
                                <span>Upload Excel</span>
                            </button>
                            <button class="btn-primary" onclick="openAddModal()" id="btnAddEvent" style="display: flex; align-items: center; gap: 8px;">
                                <span>‚ûï</span>
                                <span>Tambah Kegiatan</span>
                            </button>
                        </div>
                    </div>
                    <div id="apiStatus" style="font-size: 13px; margin-bottom: 20px; padding: 10px 15px; background: var(--bg-cream); border-radius: 10px; display: inline-block;">
                        <!-- Status will be populated by JavaScript -->
                    </div>

                    <!-- Dashboard Monitoring -->
                    <div class="dashboard-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                        <div class="stat-card-mini">
                            <div class="stat-icon-mini">üìã</div>
                            <div class="stat-content-mini">
                                <h3 id="totalActivities">0</h3>
                                <p>Total Kegiatan</p>
                            </div>
                        </div>
                        <div class="stat-card-mini">
                            <div class="stat-icon-mini">üë•</div>
                            <div class="stat-content-mini">
                                <h3 id="activeTeams">0</h3>
                                <p>Tim Aktif</p>
                            </div>
                        </div>
                        <div class="stat-card-mini">
                            <div class="stat-icon-mini">‚è∞</div>
                            <div class="stat-content-mini">
                                <h3 id="upcomingActivities">0</h3>
                                <p>Kegiatan Mendatang</p>
                            </div>
                        </div>
                    </div>

                    <div class="calendar-container">
                        <div class="calendar-header">
                            <div class="calendar-month" id="calendarMonthYear">Januari 2026</div>
                            <div class="calendar-nav">
                                <button class="btn-nav" onclick="prevMonth()">‚óÄ</button>
                                <button class="btn-nav" onclick="todayBtn()">Hari Ini</button>
                                <button class="btn-nav" onclick="nextMonth()">‚ñ∂</button>
                            </div>
                        </div>

                        <div class="calendar-grid">
                            <div class="calendar-day-header">MIN</div>
                            <div class="calendar-day-header">SEN</div>
                            <div class="calendar-day-header">SEL</div>
                            <div class="calendar-day-header">RAB</div>
                            <div class="calendar-day-header">KAM</div>
                            <div class="calendar-day-header">JUM</div>
                            <div class="calendar-day-header">SAB</div>
                        </div>

                        <div class="calendar-days-grid" id="calendarDays">
                            <!-- Days will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Modals for Calendar -->
                <!-- Modal Add Activity -->
                <div class="modal-calendar" id="addModal">
                    <div class="modal-content-calendar">
                        <div class="modal-header-calendar">
                            <h3 class="modal-title-calendar">Tambah Kegiatan Baru</h3>
                            <button class="close-btn-calendar" onclick="closeAddModal()">√ó</button>
                        </div>
                        <form id="addActivityForm">
                            <div class="form-group-calendar">
                                <label class="form-label-calendar">Tim Kerja *</label>
                                <select class="form-control-calendar" id="teamSelect" required>
                                    <option value="">-- Pilih Tim Kerja --</option>
                                    <option value="Subbag Umum">Subbag Umum</option>
                                    <option value="Duknaker Kesra">Duknaker Kesra</option>
                                    <option value="Pertanian">Pertanian</option>
                                    <option value="Ekonomi">Ekonomi</option>
                                    <option value="IPDS">IPDS</option>
                                    <option value="UKK">UKK</option>
                                    <option value="Hansos & Analisis">Hansos & Analisis</option>
                                    <option value="Neraca">Neraca</option>
                                    <option value="Harga">Harga</option>
                                    <option value="PSS RB">PSS RB</option>
                                </select>
                            </div>
                            <div class="form-group-calendar">
                                <label class="form-label-calendar">Nama Kegiatan *</label>
                                <input type="text" class="form-control-calendar" id="activityName" required placeholder="Masukkan nama kegiatan">
                            </div>
                            <div class="form-row-calendar">
                                <div class="form-group-calendar">
                                    <label class="form-label-calendar">Tanggal Mulai *</label>
                                    <input type="date" class="form-control-calendar" id="startDate" required>
                                </div>
                                <div class="form-group-calendar">
                                    <label class="form-label-calendar">Tanggal Selesai *</label>
                                    <input type="date" class="form-control-calendar" id="endDate" required>
                                </div>
                            </div>
                            <div class="modal-footer-calendar">
                                <button type="button" class="btn-secondary-calendar" onclick="closeAddModal()">Batal</button>
                                <button type="submit" class="btn-primary-calendar">Simpan Kegiatan</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Modal Upload Excel -->
                <div class="modal-calendar" id="uploadModal">
                    <div class="modal-content-calendar">
                        <div class="modal-header-calendar">
                            <h3 class="modal-title-calendar">Upload Excel Kegiatan</h3>
                            <button class="close-btn-calendar" onclick="closeUploadModal()">√ó</button>
                        </div>
                        <div class="form-group-calendar">
                            <label class="form-label-calendar">Download Template Excel</label>
                            <button type="button" class="btn-secondary-calendar" onclick="downloadTemplate()" style="width: 100%;">
                                <span>üì•</span>
                                <span>Download Template Excel</span>
                            </button>
                        </div>
                        <div class="form-group-calendar">
                            <label class="form-label-calendar">Upload File Excel</label>
                            <label class="file-upload-calendar" for="excelFile">
                                <input type="file" id="excelFile" accept=".xlsx,.xls" onchange="handleFileUpload(event)" style="display: none;">
                                <div class="file-upload-icon-calendar">üìÑ</div>
                                <div class="file-upload-text-calendar">Klik atau drag file Excel di sini</div>
                                <div class="file-upload-hint-calendar">Format: .xlsx atau .xls (max 5MB)</div>
                            </label>
                        </div>
                        <div class="modal-footer-calendar">
                            <button type="button" class="btn-secondary-calendar" onclick="closeUploadModal()">Tutup</button>
                        </div>
                    </div>
                </div>

                <!-- Modal View Day Activities -->
                <div class="modal-calendar" id="dayModal">
                    <div class="modal-content-calendar">
                        <div class="modal-header-calendar">
                            <h3 class="modal-title-calendar" id="dayModalTitle">Kegiatan</h3>
                            <button class="close-btn-calendar" onclick="closeDayModal()">√ó</button>
                        </div>
                        <div id="dayModalContent">
                            <!-- Content will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Grid 2 Columns -->
                <div class="grid-2 fade-in">
                    <!-- Employee of the Month -->
                    <div class="eom-card">
                        <div class="section-header" style="margin-bottom: 25px;">
                            <h2 class="section-title">
                                <span class="title-icon">‚≠ê</span>
                                Employee of The Month
                            </h2>
                        </div>

                        <div class="eom-content">
                            <div class="eom-photo">
                                <div class="eom-badge">üëë</div>
                                KB
                            </div>
                            <div class="eom-info">
                                <h3>Kepala BPS Kabupaten Sumbawa</h3>
                                <span class="eom-label">Januari 2026</span>
                                <p class="eom-description">
                                    Memimpin dengan visi transformasi digital dan modernisasi pelayanan statistik untuk Kabupaten Sumbawa.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Access -->
                    <div class="quick-access" style="margin: 0;">
                        <div class="access-card" onclick="showPage('matriks-perjadin')">
                            <div class="access-icon">‚úàÔ∏è</div>
                            <h3 class="access-title">Matriks Perjadin</h3>
                            <p class="access-description">Kelola perjalanan dinas</p>
                        </div>

                        <a href="https://drive.google.com/drive/folders/16fJA0z75gSpKwEdcsY9n_ntbHpnmipCk?usp=sharing" target="_blank" class="access-card">
                            <div class="access-icon">üì§</div>
                            <h3 class="access-title">Upload Kippap</h3>
                            <p class="access-description">Laporan kinerja bulanan</p>
                        </a>

                        <a href="https://amatseno13.github.io/masako/" target="_blank" class="access-card">
                            <div class="access-icon">üìä</div>
                            <h3 class="access-title">SAKIP</h3>
                            <p class="access-description">Akuntabilitas kinerja</p>
                        </a>

                        <div class="access-card" onclick="showPage('ruang-inovasi')">
                            <div class="access-icon">üí°</div>
                            <h3 class="access-title">Ruang Inovasi</h3>
                            <p class="access-description">Sampaikan ide Anda</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Administrasi Page -->
            <div id="administrasi" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="#" onclick="showPage('dashboard')">Subbag Umum</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Administrasi</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Administrasi</h1>
                        <p class="content-description">Kelola dokumen administrasi Subbag Umum BPS Kabupaten Sumbawa</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1_C71RmIk6IdLwg0kRDeT8KzQc0UmqYmO?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìú</div>
                            <div class="document-name">SK Kepala dan KPA</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/drive/folders/1baw2QtBborLLnBIifG4Kw5onqsD5V_iU?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìä</div>
                            <div class="document-name">Matriks Peran Hasil</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://script.google.com/macros/s/AKfycbxPmOeeoKz0iU6ABoHQZb8APIkOgOQFw_ThOFwY0Q0-CBGUBGPO79gfxrrTDaeBEonTpA/exec" target="_blank" class="document-item">
                            <div class="document-icon">üî¢</div>
                            <div class="document-name">Nomor Surat</div>
                            <div class="document-meta">
                                <span>üîó Apps Script</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/drive/folders/1v7KBiAGqSAwVE3sssiHagJCUD3_UdvQC?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìã</div>
                            <div class="document-name">Laporan Kegiatan</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Kepegawaian Page -->
            <div id="kepegawaian" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="#" onclick="showPage('dashboard')">Subbag Umum</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Kepegawaian</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Kepegawaian</h1>
                        <p class="content-description">Data dan dokumen kepegawaian BPS Kabupaten Sumbawa</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1qSn-OSqN_qn1O6lSG1fZS8h9d-e7PcCn?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üë§</div>
                            <div class="document-name">Existing Pegawai</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/drive/folders/19i6cvk4B3jnW9NC9oQMXTadRyqqGOS30?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìÑ</div>
                            <div class="document-name">SK Kepegawaian</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/drive/folders/17-Fkb2JkDZ4NFHjDBnd9IbNbH_ZcR5_c?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üéì</div>
                            <div class="document-name">Kompetensi Pegawai</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Keuangan Page -->
            <div id="keuangan" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="#" onclick="showPage('dashboard')">Subbag Umum</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Keuangan</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Keuangan</h1>
                        <p class="content-description">Laporan dan dokumen keuangan BPS Kabupaten Sumbawa</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1NFWE3yB-53HUehqc1TIPkzya6yjL8Fad?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üíº</div>
                            <div class="document-name">Laporan Keuangan</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/drive/folders/1sgKVsOBw9WhJTHyFb4w5kXSDxWP-i6KR?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üí∞</div>
                            <div class="document-name">LPJ Bendahara</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- BMN Page -->
            <div id="bmn" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="#" onclick="showPage('dashboard')">Subbag Umum</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>BMN</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Barang Milik Negara (BMN)</h1>
                        <p class="content-description">Manajemen dan laporan Barang Milik Negara</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/15TMO2--GSGz4VzaX7KtyAUqVzjv5BGCI?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üì¶</div>
                            <div class="document-name">Laporan BMN</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/drive/folders/113TLHTS_B4LekdcnVKMKSNMBqitWJlMo?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üîç</div>
                            <div class="document-name">Laporan Kondisi Barang</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/drive/folders/1Xu4Q2nT-AuRTMjXIqRvGRsPuPtW9NP4c?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìã</div>
                            <div class="document-name">Daftar Pemegang BMN</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Anggaran Page -->
            <div id="anggaran" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="#" onclick="showPage('dashboard')">Subbag Umum</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Anggaran</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Anggaran</h1>
                        <p class="content-description">Dokumen perencanaan dan revisi anggaran</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://docs.google.com/spreadsheets/d/1n0BIyS-xiVUZpRdbVxt4dOzFaWLeMWr4/edit?pli=1&gid=832803666#gid=832803666" target="_blank" class="document-item">
                            <div class="document-icon">üìä</div>
                            <div class="document-name">CAPUT</div>
                            <div class="document-meta">
                                <span>üìä Google Sheets</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/drive/folders/1qVVnJsD7oZCy18JJD6G61-iKIY-OhisD?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üîÑ</div>
                            <div class="document-name">Revisi Dipa dan POK</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Humas Page -->
            <div id="humas" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="#" onclick="showPage('dashboard')">Subbag Umum</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Humas</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Hubungan Masyarakat</h1>
                        <p class="content-description">Dokumentasi dan rencana publikasi</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1kR_gm9XIoYvoMt6Pct3ozUGOp7xivf1R?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üì∏</div>
                            <div class="document-name">Dokumentasi Humas</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://docs.google.com/spreadsheets/d/1WUoRzm6HtQEq08K8Sx2XZg_bhGIOtA9t/edit?usp=sharing&ouid=105109098673296728366&rtpof=true&sd=true" target="_blank" class="document-item">
                            <div class="document-icon">üì∞</div>
                            <div class="document-name">Rencana Rilis</div>
                            <div class="document-meta">
                                <span>üìä Google Sheets</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Template untuk page lainnya (bisa diduplikasi) -->
            <div id="duknaker-kesra" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Duknaker Kesra</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Duknaker Kesra</h1>
                        <p class="content-description">Arsip dan sistem Tim Duknaker Kesra</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1uCGmcrQplzeQoKi6mLYbNJZoESx90vWi?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Rumah Arsip</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://olah.web.bps.go.id/seruti/" target="_blank" class="document-item">
                            <div class="document-icon">üìä</div>
                            <div class="document-name">Seruti</div>
                            <div class="document-meta">
                                <span>üîó External Link</span>
                            </div>
                        </a>

                        <div class="document-item" onclick="showPage('monitoring-duknaker')">
                            <div class="document-icon">üìà</div>
                            <div class="document-name">Monitoring Kegiatan</div>
                            <div class="document-meta">
                                <span>üìã Internal Page</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pertanian Page -->
            <div id="pertanian" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Pertanian</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Pertanian</h1>
                        <p class="content-description">Arsip dan sistem manajemen Tim Pertanian</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1POghYemsxJ19Mn4DoMfohTN94Oe47pxi?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Rumah Arsip</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://manajemen-ksapro.bps.go.id/" target="_blank" class="document-item">
                            <div class="document-icon">üåΩ</div>
                            <div class="document-name">KSA Jagung</div>
                            <div class="document-meta">
                                <span>üîó Manajemen KSA</span>
                            </div>
                        </a>

                        <a href="https://ksapro-manajemen.bps.go.id/index" target="_blank" class="document-item">
                            <div class="document-icon">üåæ</div>
                            <div class="document-name">KSA Padi</div>
                            <div class="document-meta">
                                <span>üîó Manajemen KSA</span>
                            </div>
                        </a>

                        <a href="https://iframe.bps.go.id/sampling/padi/" target="_blank" class="document-item">
                            <div class="document-icon">üìä</div>
                            <div class="document-name">Manajemen Sampel Ubinan Padi</div>
                            <div class="document-meta">
                                <span>üîó Sistem Sampling</span>
                            </div>
                        </a>

                        <a href="https://iframe.bps.go.id/sampling/palawija" target="_blank" class="document-item">
                            <div class="document-icon">üìà</div>
                            <div class="document-name">Manajemen Sampel Ubinan Palawija</div>
                            <div class="document-meta">
                                <span>üîó Sistem Sampling</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Ekonomi Page -->
            <div id="ekonomi" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Ekonomi</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Ekonomi</h1>
                        <p class="content-description">Arsip dokumen Tim Ekonomi</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1pe1pA6Ah2seYChOAtL5jiEg29Tses8JY?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Rumah Arsip</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- IPDS Page -->
            <div id="ipds" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>IPDS</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">IPDS</h1>
                        <p class="content-description">Integrasi Pengolahan dan Diseminasi Statistik</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1-x3lWJEuVZxCn0tFBOFcd5o2fp8dFi0_?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Rumah Arsip</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- UKK Page -->
            <div id="ukk" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>UKK</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">UKK</h1>
                        <p class="content-description">Usaha Kecil dan Menengah</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1LtWqrouIB4i3USFxiJRMgrNKgBp_Niyb?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Rumah Arsip</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Hansos Page -->
            <div id="hansos" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Hansos & Analisis Statistik</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Hansos & Analisis Statistik</h1>
                        <p class="content-description">Survei Sosial dan Analisis Statistik</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1hxxRkSgSz70z2hSIEYTwCJGTEpzf5W0t?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Rumah Arsip</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Neraca Page -->
            <div id="neraca" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Neraca</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Neraca</h1>
                        <p class="content-description">Statistik Neraca dan Analisis Ekonomi</p>
                    </div>

                    <div class="document-grid">
                        <a href="http://s.bps.go.id/DriveNeraca5204" target="_blank" class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Rumah Arsip</div>
                            <div class="document-meta">
                                <span>üîó BPS Shortlink</span>
                            </div>
                        </a>

                        <a href="http://s.bps.go.id/MatriksKegatanNAS2024" target="_blank" class="document-item">
                            <div class="document-icon">üìã</div>
                            <div class="document-name">Matriks Kegiatan</div>
                            <div class="document-meta">
                                <span>üîó BPS Shortlink</span>
                            </div>
                        </a>

                        <a href="http://s.bps.go.id/5204Snapshot_Perekonomian" target="_blank" class="document-item">
                            <div class="document-icon">üì∏</div>
                            <div class="document-name">Snapper</div>
                            <div class="document-meta">
                                <span>üîó BPS Shortlink</span>
                            </div>
                        </a>

                        <a href="http://s.bps.go.id/fenomena5204" target="_blank" class="document-item">
                            <div class="document-icon">üîÑ</div>
                            <div class="document-name">Rekap Fenomena</div>
                            <div class="document-meta">
                                <span>üîó BPS Shortlink</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Harga Page -->
            <div id="harga" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Harga</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Harga</h1>
                        <p class="content-description">Statistik Harga dan Inflasi</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1fknnRo0siOeBMD7s_xIVQ5gO80AEeAmk?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Rumah Arsip</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://shk.bps.go.id" target="_blank" class="document-item">
                            <div class="document-icon">üìä</div>
                            <div class="document-name">SHK</div>
                            <div class="document-meta">
                                <span>üîó Survei Harga Konsumen</span>
                            </div>
                        </a>

                        <a href="https://shpb.web.bps.go.id" target="_blank" class="document-item">
                            <div class="document-icon">üìà</div>
                            <div class="document-name">SHPB</div>
                            <div class="document-meta">
                                <span>üîó Survei Harga Produsen</span>
                            </div>
                        </a>

                        <a href="https://shp.web.bps.go.id/" target="_blank" class="document-item">
                            <div class="document-icon">üíπ</div>
                            <div class="document-name">SHP</div>
                            <div class="document-meta">
                                <span>üîó Survei Harga Perdagangan</span>
                            </div>
                        </a>

                        <a href="https://webentry.bps.go.id/shped/dashboard" target="_blank" class="document-item">
                            <div class="document-icon">üìâ</div>
                            <div class="document-name">SHPED</div>
                            <div class="document-meta">
                                <span>üîó Survei Harga Perdesaan</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Template untuk page lainnya (bisa diduplikasi) -->
            <div id="rumah-arsip-duknaker" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="#" onclick="showPage('dashboard')">Duknaker Kesra</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Rumah Arsip</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Rumah Arsip - Duknaker Kesra</h1>
                        <p class="content-description">Arsip dokumen Tim Duknaker Kesra</p>
                    </div>

                    <div class="document-grid">
                        <div class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Dokumen 2025</div>
                            <div class="document-meta">
                                <span>üìÅ 24 Dokumen</span>
                            </div>
                        </div>

                        <div class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Dokumen 2024</div>
                            <div class="document-meta">
                                <span>üìÅ 156 Dokumen</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PSS Page -->
            <div id="pss" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="#" onclick="showPage('dashboard')">PSS RB</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>PSS</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">PSS (Pembinaan Statistik Sektoral)</h1>
                        <p class="content-description">Sistem dan dokumentasi Pembinaan Statistik Sektoral</p>
                    </div>

                    <div class="document-grid">
                        <a href="http://s.bps.go.id/dok_pembinaan/" target="_blank" class="document-item">
                            <div class="document-icon">üìö</div>
                            <div class="document-name">TPSS</div>
                            <div class="document-meta">
                                <span>üîó Dokumen Pembinaan</span>
                            </div>
                        </a>

                        <a href="https://romantik.web.bps.go.id/" target="_blank" class="document-item">
                            <div class="document-icon">üìä</div>
                            <div class="document-name">Romantik</div>
                            <div class="document-meta">
                                <span>üîó Sistem Romantik</span>
                            </div>
                        </a>

                        <a href="https://INDAH.bps.go.id" target="_blank" class="document-item">
                            <div class="document-icon">üåê</div>
                            <div class="document-name">Indonesia Data Hub</div>
                            <div class="document-meta">
                                <span>üîó INDAH</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- ZI Page -->
            <div id="zi" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="#" onclick="showPage('dashboard')">PSS RB</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>ZI</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Zona Integritas (ZI)</h1>
                        <p class="content-description">Dokumentasi dan monitoring Zona Integritas menuju WBK/WBBM</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1zFSeaxFx6dHJBOouzl_ie2Y27nZuvX_n?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìÇ</div>
                            <div class="document-name">Rumah RB Lama</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/drive/folders/12VthKohl-6lT5DqcoNiM4rSsQvKIHCaG?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üÜï</div>
                            <div class="document-name">Rumah RB Baru</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>

                        <a href="https://docs.google.com/spreadsheets/d/18uqkHIzDHPvVY-qhTSRzbCyR7pGDS2b_sQI8QYDf7wk/edit?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üåê</div>
                            <div class="document-name">LKE Online Pusat</div>
                            <div class="document-meta">
                                <span>üìä Google Sheets</span>
                            </div>
                        </a>

                        <a href="https://linktr.ee/zi5225" target="_blank" class="document-item">
                            <div class="document-icon">üí°</div>
                            <div class="document-name">ZI Pintar NTB</div>
                            <div class="document-meta">
                                <span>üîó Linktree</span>
                            </div>
                        </a>

                        <a href="https://docs.google.com/spreadsheets/d/1ylp7WuyjkwVzr6zq8802V1fWRg8fcivii5Xi4JNefGc/edit?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìä</div>
                            <div class="document-name">Monitoring Rencana Aksi ZI 2025</div>
                            <div class="document-meta">
                                <span>üìä Google Sheets</span>
                            </div>
                        </a>

                        <a href="https://docs.google.com/spreadsheets/d/1M5pUtHtg0vmpIf0rS8texGfTeuTH3d3YAcWcK38QnEU/edit?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üîß</div>
                            <div class="document-name">LKE dan Rencana Aksi ZI Perbaikan</div>
                            <div class="document-meta">
                                <span>üìä Google Sheets</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/file/d/1oBqajPcN7Ng7djsrILBd1MqYXuAK48jQ/view?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìã</div>
                            <div class="document-name">LHE ZI Pusat</div>
                            <div class="document-meta">
                                <span>üìÑ PDF Document</span>
                            </div>
                        </a>

                        <a href="https://drive.google.com/file/d/1gcjTnLL3hzxyldhlG2Ne_rOBkAVx5t67/view?usp=sharing" target="_blank" class="document-item">
                            <div class="document-icon">üìé</div>
                            <div class="document-name">Contoh Bukti Dukung</div>
                            <div class="document-meta">
                                <span>üìÑ PDF Document</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Descan Page -->
            <div id="descan" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <a href="#" onclick="showPage('dashboard')">PSS RB</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Descan</span>
                </div>

                <div class="content-card fade-in">
                    <div class="content-header">
                        <h1 class="content-title">Descan</h1>
                        <p class="content-description">Deskripsi Pekerjaan dan Analisis</p>
                    </div>

                    <div class="document-grid">
                        <a href="https://drive.google.com/drive/folders/1gkyLK_R0H4-s9ypd1kuM1wDpsOdqcjHd?usp=drive_link" target="_blank" class="document-item">
                            <div class="document-icon">üìÅ</div>
                            <div class="document-name">Arsip Descan</div>
                            <div class="document-meta">
                                <span>üìÅ Google Drive</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Tambahan pages lain dengan struktur yang sama... -->
            
            <!-- Matriks Perjadin Page -->
            <div id="matriks-perjadin" class="page-content">
                <div class="breadcrumb">
                    <a href="#" onclick="showPage('dashboard')">Beranda</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span>Matriks Perjadin</span>
                </div>

                <div class="embedded-sheet-container fade-in">
                    <div class="embedded-sheet-header">
                        <h1 class="embedded-sheet-title">
                            <span class="title-icon">‚úàÔ∏è</span>
                            Matriks Perjalanan Dinas
                        </h1>
                        <p class="embedded-sheet-description">
                            Kelola dan monitoring perjalanan dinas pegawai BPS Kabupaten Sumbawa. Anda dapat langsung mengedit spreadsheet di bawah ini atau membuka di tab baru untuk fitur lengkap.
                        </p>
                        <div class="embedded-sheet-actions">
                            <a href="https://docs.google.com/spreadsheets/d/1KF54clc4k0Fl_ErEhAO4U0_svLHfpzDh7CniyZzkI-0/edit?usp=sharing" target="_blank" class="btn-sheet primary">
                                <span>üîó</span>
                                <span>Buka di Google Sheets</span>
                            </a>
                            <button class="btn-sheet" onclick="refreshSheet()">
                                <span>üîÑ</span>
                                <span>Refresh</span>
                            </button>
                        </div>
                    </div>
                    
                    <iframe 
                        id="perjadinSheet"
                        class="sheet-iframe"
                        src="https://docs.google.com/spreadsheets/d/1KF54clc4k0Fl_ErEhAO4U0_svLHfpzDh7CniyZzkI-0/edit?usp=sharing&rm=minimal&widget=true&chrome=false"
                        allowfullscreen>
                    </iframe>
                    
                    <div class="sheet-info">
                        <span class="sheet-info-icon">‚ÑπÔ∏è</span>
                        <span>Tip: Klik dua kali pada cell untuk mengedit. Perubahan akan tersimpan otomatis ke Google Sheets.</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // ============================================
        // OLD CALENDAR CODE SECTION
        // ============================================
        
        // KONFIGURASI API - GANTI DENGAN URL ANDA
     //   const API_URL = 'PASTE_URL_APPS_SCRIPT_ANDA_DISINI';
        // Contoh: 'https://script.google.com/macros/s/AKfycby.../exec'
        
        // State Management
       // let currentMonth = new Date().getMonth(); // 0-11
        //let currentYear = new Date().getFullYear();
        //let allEvents = [];
        
        // Load events dari Google Sheets  
        // (Old code - not used)
        //async function loadEvents() {
          //  try {
            //    const response = await fetch(`${API_URL}?action=getAllEvents`);
              //  const result = await response.json();
                
               // if (result.status === 'success') {
                    allEvents = result.data;
                    console.log(`‚úÖ Loaded ${allEvents.length} events from Google Sheets`);
                    renderCalendar();
               // } else {
               //     console.error('‚ùå Error loading events:', result.message);
                 //   alert('Gagal memuat data kegiatan. Pastikan API URL sudah benar.');
              //  }
          //  } catch (error) {
            //    console.error('‚ùå API Connection Error:', error);
              //  alert('Tidak dapat terhubung ke Google Sheets. Periksa koneksi dan API URL.');
          //  }
       // }
        
        // Render Calendar
        function renderCalendar() {
            const monthNames = [
                'Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
                'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'
            ];
            
            // Update month title
            document.querySelector('.calendar-month').textContent = 
                `${monthNames[currentMonth]} ${currentYear}`;
            
            // Get calendar grid
            const calendarGrid = document.querySelector('.calendar-grid');
            
            // Clear existing days (keep headers)
            const headers = calendarGrid.querySelectorAll('.calendar-day-header');
            calendarGrid.innerHTML = '';
            headers.forEach(header => calendarGrid.appendChild(header));
            
            // Get first day of month and number of days
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const daysInPrevMonth = new Date(currentYear, currentMonth, 0).getDate();
            
            // Today's date
            const today = new Date();
            const isCurrentMonth = today.getMonth() === currentMonth && 
                                   today.getFullYear() === currentYear;
            const todayDate = today.getDate();
            
            // Add previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const day = daysInPrevMonth - i;
                calendarGrid.appendChild(createDayElement(day, true, false));
            }
            
            // Add current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = isCurrentMonth && day === todayDate;
                const eventsOnDay = getEventsForDate(currentYear, currentMonth, day);
                calendarGrid.appendChild(createDayElement(day, false, isToday, eventsOnDay));
            }
            
            // Add next month days to fill grid
            const totalCells = calendarGrid.children.length - 7; // minus headers
            const remainingCells = 42 - totalCells; // 6 weeks * 7 days
            for (let day = 1; day <= remainingCells; day++) {
                calendarGrid.appendChild(createDayElement(day, true, false));
            }
        }
        
        // Create day element
        function createDayElement(day, isOtherMonth, isToday, events = []) {
            const dayEl = document.createElement('div');
            dayEl.className = 'calendar-day';
            
            if (isOtherMonth) {
                dayEl.classList.add('other-month');
            }
            if (isToday) {
                dayEl.classList.add('today');
            }
            if (events.length > 0) {
                dayEl.classList.add('has-event');
            }
            
            const dayNumber = document.createElement('div');
            dayNumber.className = 'day-number';
            dayNumber.textContent = day;
            dayEl.appendChild(dayNumber);
            
            // Add first event as preview
            if (events.length > 0) {
                const eventEl = document.createElement('div');
                eventEl.className = 'day-event';
                eventEl.textContent = events[0].Judul_Kegiatan;
                if (events.length > 1) {
                    eventEl.textContent += ` +${events.length - 1}`;
                }
                dayEl.appendChild(eventEl);
            }
            
            // Click handler
            if (!isOtherMonth) {
                dayEl.onclick = () => showDayEvents(day, events);
            }
            
            return dayEl;
        }
        
        // Get events for specific date
        function getEventsForDate(year, month, day) {
            return allEvents.filter(event => {
                const eventDate = new Date(event.Tanggal_Mulai);
                return eventDate.getFullYear() === year &&
                       eventDate.getMonth() === month &&
                       eventDate.getDate() === day;
            });
        }
        
        // Show events for a specific day
        function showDayEvents(day, events) {
            const monthNames = [
                'Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
                'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'
            ];
            
            const date = `${day} ${monthNames[currentMonth]} ${currentYear}`;
            
            if (events.length === 0) {
                alert(`üìÖ ${date}\n\nTidak ada kegiatan.\n\nKlik "Tambah Kegiatan" untuk menambah kegiatan baru.`);
            } else {
                let message = `üìÖ ${date}\n\nKegiatan hari ini:\n\n`;
                events.forEach((event, index) => {
                    message += `${index + 1}. ${event.Judul_Kegiatan}\n`;
                    message += `   Tim: ${event.Tim_Kerja}\n`;
                    message += `   Waktu: ${event.Waktu_Mulai} - ${event.Waktu_Selesai}\n`;
                    if (event.Lokasi) {
                        message += `   Lokasi: ${event.Lokasi}\n`;
                    }
                    message += `\n`;
                });
                alert(message);
            }
        }
        
        // Navigate calendar
        function prevMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        }
        
        function nextMonth() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        }
        
        // Add event
        async function addEvent() {
            // Simple form using prompts (bisa diganti dengan modal yang lebih bagus)
            const timKerja = prompt('Tim Kerja:\n(contoh: IPDS, Subbag Umum, Pertanian, dll)');
            if (!timKerja) return;
            
            const judul = prompt('Judul Kegiatan:');
            if (!judul) return;
            
            const tanggal = prompt('Tanggal (YYYY-MM-DD):\n(contoh: 2026-01-15)');
            if (!tanggal) return;
            
            const waktuMulai = prompt('Waktu Mulai (HH:MM):\n(contoh: 09:00)');
            const waktuSelesai = prompt('Waktu Selesai (HH:MM):\n(contoh: 11:00)');
            const lokasi = prompt('Lokasi:');
            const deskripsi = prompt('Deskripsi:');
            const penanggungJawab = prompt('Penanggung Jawab:');
            
            const eventData = {
                Tim_Kerja: timKerja,
                Judul_Kegiatan: judul,
                Tanggal_Mulai: tanggal,
                Tanggal_Selesai: tanggal,
                Waktu_Mulai: waktuMulai || '',
                Waktu_Selesai: waktuSelesai || '',
                Lokasi: lokasi || '',
                Deskripsi: deskripsi || '',
                Status: 'Active',
                Penanggung_Jawab: penanggungJawab || '',
                Peserta: '',
                Warna: '#FF6B35'
            };
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    body: JSON.stringify(eventData),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    alert('‚úÖ Kegiatan berhasil ditambahkan!');
                    loadEvents(); // Reload events
                } else {
                    alert('‚ùå Gagal menambah kegiatan: ' + result.message);
                }
            } catch (error) {
                console.error('Error adding event:', error);
                alert('‚ùå Error: ' + error.message);
            }
        }
        
        // Initialize on page load
        window.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ SAMAWA Calendar System');
            console.log('üì° API URL:', API_URL);
            
            if (API_URL === 'PASTE_URL_APPS_SCRIPT_ANDA_DISINI') {
                alert('‚ö†Ô∏è PERHATIAN!\n\nAPI belum dikonfigurasi.\nSilakan ikuti panduan SETUP_GOOGLE_SHEETS.md untuk setup Google Sheets.');
            } else {
                loadEvents();
            }
            
            // Setup navigation buttons
            const prevBtn = document.querySelectorAll('.btn-nav')[0];
            const nextBtn = document.querySelectorAll('.btn-nav')[1];
            
            if (prevBtn) prevBtn.onclick = prevMonth;
            if (nextBtn) nextBtn.onclick = nextMonth;
        });

        // Toggle Menu
        function toggleMenu(element) {
            const submenu = element.nextElementSibling;
            const isOpen = element.classList.contains('open');
            
            // Toggle current menu
            element.classList.toggle('open');
            submenu.classList.toggle('open');
        }

        // Toggle Submenu (Level 3)
        function toggleSubmenu(element, event) {
            if (event) event.stopPropagation();
            
            const submenuNested = element.nextElementSibling;
            const isOpen = element.classList.contains('open');
            
            // Toggle current submenu
            element.classList.toggle('open');
            if (submenuNested) {
                submenuNested.classList.toggle('open');
            }
        }

        // Show Page
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
            });

            // Show selected page
            const selectedPage = document.getElementById(pageId);
            if (selectedPage) {
                selectedPage.classList.add('active');
                
                // Update active menu
                document.querySelectorAll('.menu-link, .submenu-link').forEach(link => {
                    link.classList.remove('active');
                });
                
                // Update page title
                const pageTitles = {
                    'dashboard': 'Dashboard',
                    'administrasi': 'Administrasi',
                    'kepegawaian': 'Kepegawaian',
                    'keuangan': 'Keuangan',
                    'bmn': 'BMN',
                    'anggaran': 'Anggaran',
                    'humas': 'Humas',
                    'duknaker-kesra': 'Duknaker Kesra',
                    'pertanian': 'Pertanian',
                    'ekonomi': 'Ekonomi',
                    'ipds': 'IPDS',
                    'ukk': 'UKK',
                    'hansos': 'Hansos & Analisis',
                    'neraca': 'Neraca',
                    'harga': 'Harga',
                    'pss': 'PSS',
                    'zi': 'Zona Integritas',
                    'descan': 'Descan',
                    'matriks-perjadin': 'Matriks Perjadin',
                    'kippap': 'Upload Kippap Bulanan',
                    'sakip': 'SAKIP',
                    'ruang-inovasi': 'Ruang Inovasi'
                };
                
                document.getElementById('pageTitle').textContent = pageTitles[pageId] || 'SAMAWA';
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Close mobile sidebar
                if (window.innerWidth <= 768) {
                    document.getElementById('sidebar').classList.remove('open');
                }
            }
        }

        // Toggle Sidebar (Mobile)
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        // Refresh Sheet iframe
        function refreshSheet() {
            const iframe = document.getElementById('perjadinSheet');
            if (iframe) {
                iframe.src = iframe.src;
                // Show notification
                const btn = event.target.closest('button');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<span>‚úì</span><span>Refreshed!</span>';
                btn.style.background = '#10B981';
                btn.style.color = 'white';
                btn.style.borderColor = '#10B981';
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '';
                    btn.style.color = '';
                    btn.style.borderColor = '';
                }, 2000);
            }
        }

        // Header shadow on scroll
        window.addEventListener('scroll', function() {
            const header = document.querySelector('.top-header');
            if (window.scrollY > 10) {
                header.style.boxShadow = '0 4px 15px rgba(0, 0, 0, 0.08)';
            } else {
                header.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.03)';
            }
        });

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                const menuBtn = document.querySelector('.mobile-menu-btn');
                
                if (!sidebar.contains(event.target) && !menuBtn.contains(event.target)) {
                    sidebar.classList.remove('open');
                }
            }
        });
        
        // END OF OLD CALENDAR CODE
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // ========================================
        // GOOGLE CALENDAR API CONFIGURATION
        // ========================================
        // TODO: Paste your API Key from Google Cloud Console here
        const GOOGLE_API_KEY = 'AIzaSyDs6uykI_-bIYwUNGJdvKCtXKlUqVWDOQw';
        
        // TODO: Paste your 10 Calendar IDs from Google Calendar here
        const CALENDAR_IDS = {
            "Subbag Umum": "0b7e052cdca7d327672f47c1a411041ea27a3c7ea1993b88fe6dfed282361f42@group.calendar.google.com",
            "Duknaker Kesra": "a578551805dc4b23479a9f38682b48fed012e2f81204cad7322e69cb69d471a9@group.calendar.google.com",
            "Pertanian": "fabbfc70451c95392e99fe611c00b29748c37313ecdc9e4576cea5a70c477956@group.calendar.google.com",
            "Ekonomi": "4b6ac709553d266850f607a33369eca7fe29790d2381df402246cc567446be40@group.calendar.google.com",
            "IPDS": "4c245cdd1131953f69c2d1a0ddf8ec86b9bac16a9df5ec53a7b397588911fc3e@group.calendar.google.com",
            "UKK": "1d021c626d26f46a623cec1333b08d07cfb6768163c35627df667a0331b38d81@group.calendar.google.com",
            "Hansos & Analisis": "b3dd7dd7a46ca80d4efeae694370941f58f25d6464deb0f9bfa71d30c9096620@group.calendar.google.com",
            "Neraca": "32aaf17b7ab2b048fbb40e97400e4d177a160add46a8bc0ed0474c97b55f290c@group.calendar.google.com",
            "Harga": "1062b3fa36ada664657f7a162e6d00b89c081dfa572b61eceb36024db842c1e4@group.calendar.google.com",
            "PSS RB": "22c221f3a549d3b19db7a6fb33a8cffb187712ae096410dd5392d500717d7519@group.calendar.google.com"
        };
        
        const USE_GOOGLE_CALENDAR = (GOOGLE_API_KEY !== 'AIzaSyDs6uykI_-bIYwUNGJdvKCtXKlUqVWDOQw');
        const USE_CALENDAR_API = false; // Old Google Sheets API disabled

        // ========================================
        // CALENDAR GLOBAL VARIABLES
        // ========================================
        let currentCalendarDate = new Date();
        let allActivities = [];

        const teams = [
            "Subbag Umum", "Duknaker Kesra", "Pertanian", "Ekonomi", "IPDS",
            "UKK", "Hansos & Analisis", "Neraca", "Harga", "PSS RB"
        ];

        // Color mapping for each team
        const teamColors = {
            "Subbag Umum": "#FF6B35",        // Orange
            "Duknaker Kesra": "#4ECDC4",    // Teal
            "Pertanian": "#95E1D3",         // Mint Green
            "Ekonomi": "#F38181",           // Pink
            "IPDS": "#AA96DA",              // Purple
            "UKK": "#FCBAD3",               // Light Pink
            "Hansos & Analisis": "#FFFFD2", // Light Yellow
            "Neraca": "#A8D8EA",            // Sky Blue
            "Harga": "#FFABAB",             // Salmon
            "PSS RB": "#FFC8C8"             // Peach
        };

        function getTeamColor(team) {
            return teamColors[team] || "#FF6B35"; // Default orange
        }

        // ========================================
        // CALENDAR API FUNCTIONS
        // ========================================
        
        async function loadCalendarActivities() {
            // Try Google Calendar first
            if (USE_GOOGLE_CALENDAR && GOOGLE_API_KEY !== 'AIzaSyDs6uykI_-bIYwUNGJdvKCtXKlUqVWDOQw') {
                const success = await loadEventsFromGoogleCalendar();
                if (success) {
                    return true;
                }
            }
            
            // Fallback to localStorage
            console.log('[Calendar] Using localStorage');
            loadFromLocalStorage();
            return false;
        }

        // ========================================
        // GOOGLE CALENDAR FUNCTIONS
        // ========================================
        
        async function loadEventsFromGoogleCalendar() {
            if (!USE_GOOGLE_CALENDAR || GOOGLE_API_KEY === 'AIzaSyDs6uykI_-bIYwUNGJdvKCtXKlUqVWDOQw') {
                return false;
            }
            
            try {
                console.log('[Google Calendar] Loading events...');
                allActivities = [];
                
                const startOfMonth = new Date(currentCalendarDate.getFullYear(), currentCalendarDate.getMonth() - 1, 1);
                const endOfMonth = new Date(currentCalendarDate.getFullYear(), currentCalendarDate.getMonth() + 2, 0);
                const timeMin = startOfMonth.toISOString();
                const timeMax = endOfMonth.toISOString();
                
                for (const [teamName, calendarId] of Object.entries(CALENDAR_IDS)) {
                    if (calendarId && calendarId.includes('@group.calendar.google.com')) {
                        await loadEventsFromSingleCalendar(teamName, calendarId, timeMin, timeMax);
                    }
                }
                
                console.log('[Google Calendar] ‚úÖ Loaded:', allActivities.length, 'events');
                return true;
            } catch (error) {
                console.error('[Google Calendar] ‚ùå Error:', error);
                return false;
            }
        }
        
        async function loadEventsFromSingleCalendar(teamName, calendarId, timeMin, timeMax) {
            try {
                const url = `https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(calendarId)}/events?key=${GOOGLE_API_KEY}&timeMin=${timeMin}&timeMax=${timeMax}&singleEvents=true&orderBy=startTime`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    console.warn(`[Google Calendar] ${teamName}: HTTP ${response.status}`);
                    return;
                }
                
                const data = await response.json();
                
                if (data.items && data.items.length > 0) {
                    data.items.forEach(event => {
                        const startDate = event.start.date || event.start.dateTime.split('T')[0];
                        const endDate = event.end.date || event.end.dateTime.split('T')[0];
                        const adjustedEndDate = new Date(endDate);
                        adjustedEndDate.setDate(adjustedEndDate.getDate() - 1);
                        const finalEndDate = adjustedEndDate.toISOString().split('T')[0];
                        
                        allActivities.push({
                            id: event.id,
                            team: teamName,
                            name: event.summary || 'Untitled Event',
                            startDate: startDate,
                            endDate: finalEndDate >= startDate ? finalEndDate : startDate
                        });
                    });
                }
            } catch (error) {
                console.error(`[Google Calendar] ${teamName} error:`, error);
            }
        }

        function loadFromLocalStorage() {
            const stored = localStorage.getItem('samawa_activities');
            if (stored) {
                allActivities = JSON.parse(stored);
                console.log('[Calendar] Loaded from localStorage:', allActivities.length, 'activities');
            } else {
                allActivities = [
                    { team: "IPDS", name: "Rapat Koordinasi Bulanan", startDate: "2026-01-10", endDate: "2026-01-10" },
                    { team: "Subbag Umum", name: "Workshop Administrasi", startDate: "2026-01-15", endDate: "2026-01-16" },
                    { team: "Pertanian", name: "Survei KSA Padi", startDate: "2026-01-20", endDate: "2026-01-22" }
                ];
                saveToLocalStorage();
            }
        }

        async function saveToCalendarAPI(activity) {
            if (!USE_CALENDAR_API || !CALENDAR_API_URL) {
                console.warn('[Calendar] API not configured');
                return false;
            }
            
            try {
                console.log('[Calendar] Saving to API:', activity);
                
                const response = await fetch(`${AIzaSyDs6uykI_-bIYwUNGJdvKCtXKlUqVWDOQw}?action=add`, {
                    method: 'POST',
                    mode: 'cors',
                    headers: { 
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(activity)
                });
                
                console.log('[Calendar] Save response status:', response.status);
                
                if (!response.ok) {
                    console.error('[Calendar] HTTP Error:', response.status, response.statusText);
                    return false;
                }
                
                const text = await response.text();
                console.log('[Calendar] Save response text:', text);
                
                const result = JSON.parse(text);
                console.log('[Calendar] Save result:', result);
                
                if (result.status === 'success') {
                    console.log('[Calendar] ‚úÖ Saved to API successfully');
                    return true;
                } else {
                    console.error('[Calendar] API returned error:', result.message);
                    return false;
                }
            } catch (error) {
                console.error('[Calendar] ‚ùå Failed to save to API:', error);
                return false;
            }
        }

        function saveToLocalStorage() {
            localStorage.setItem('samawa_activities', JSON.stringify(allActivities));
        }

        // ========================================
        // CALENDAR RENDER FUNCTIONS
        // ========================================
        
        function renderSamawaCalendar() {
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            
            const monthNames = ["Januari", "Februari", "Maret", "April", "Mei", "Juni",
                              "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
            document.getElementById('calendarMonthYear').textContent = `${monthNames[month]} ${year}`;

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();

            const daysContainer = document.getElementById('calendarDays');
            daysContainer.innerHTML = '';

            for (let i = firstDay - 1; i >= 0; i--) {
                const day = daysInPrevMonth - i;
                daysContainer.appendChild(createDayElement(day, true, false));
            }

            const today = new Date();
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = day === today.getDate() && month === today.getMonth() && year === today.getFullYear();
                daysContainer.appendChild(createDayElement(day, false, isToday));
            }

            const remainingDays = 42 - (firstDay + daysInMonth);
            for (let day = 1; day <= remainingDays; day++) {
                daysContainer.appendChild(createDayElement(day, true, false));
            }

            updateDashboardStats();
        }

        function createDayElement(day, isOtherMonth, isToday) {
            const div = document.createElement('div');
            div.className = 'calendar-day';
            if (isOtherMonth) div.classList.add('other-month');
            if (isToday) div.classList.add('today');

            const dateStr = `${currentCalendarDate.getFullYear()}-${String(currentCalendarDate.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            const events = getEventsForDate(dateStr);

            if (events.length > 0 && !isOtherMonth) {
                div.classList.add('has-event');
                
                // Add colored badges for each team
                const eventBadges = events.map(event => {
                    const color = getTeamColor(event.team);
                    return `<div class="event-badge" style="background-color: ${color}; border-left: 3px solid ${color};"></div>`;
                }).join('');
                
                div.innerHTML = `
                    <div class="day-number">${day}</div>
                    <div class="day-events-container">
                        ${eventBadges}
                    </div>
                    <div class="day-event-count">${events.length} kegiatan</div>
                `;
            } else {
                div.innerHTML = `<div class="day-number">${day}</div>`;
            }

            if (!isOtherMonth) {
                div.onclick = () => showDayActivities(dateStr, events);
            }

            return div;
        }

        function getEventsForDate(dateStr) {
            return allActivities.filter(activity => {
                return dateStr >= activity.startDate && dateStr <= activity.endDate;
            });
        }

        function showDayActivities(dateStr, events) {
            const date = new Date(dateStr);
            const monthNames = ["Januari", "Februari", "Maret", "April", "Mei", "Juni",
                              "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
            
            document.getElementById('dayModalTitle').textContent = 
                `Kegiatan ${date.getDate()} ${monthNames[date.getMonth()]} ${date.getFullYear()}`;

            let content = '';
            if (events.length === 0) {
                content = '<div style="text-align: center; padding: 60px 20px; color: var(--text-gray);"><div style="font-size: 64px; margin-bottom: 15px;">üì≠</div><p>Tidak ada kegiatan pada tanggal ini</p></div>';
            } else {
                content = '<div style="display: flex; flex-direction: column; gap: 15px;">';
                events.forEach(event => {
                    const teamColor = getTeamColor(event.team);
                    content += `
                        <div style="padding: 15px; background: var(--bg-cream); border-radius: 12px; border-left: 4px solid ${teamColor};">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                <h4 style="font-weight: 600; color: var(--text-dark); margin: 0;">${event.name}</h4>
                                <span style="display: inline-block; padding: 6px 12px; border-radius: 8px; font-size: 12px; font-weight: 600; background: ${teamColor}; color: white;">${event.team}</span>
                            </div>
                            <p style="font-size: 13px; color: var(--text-gray); margin: 0;">
                                üìÖ ${formatDateDisplay(event.startDate)} - ${formatDateDisplay(event.endDate)}
                            </p>
                        </div>
                    `;
                });
                content += '</div>';
            }

            document.getElementById('dayModalContent').innerHTML = content;
            document.getElementById('dayModal').classList.add('active');
        }

        function updateDashboardStats() {
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            
            const monthActivities = allActivities.filter(activity => {
                const startDate = new Date(activity.startDate);
                const endDate = new Date(activity.endDate);
                const monthStart = new Date(year, month, 1);
                const monthEnd = new Date(year, month + 1, 0);
                
                return (startDate >= monthStart && startDate <= monthEnd) ||
                       (endDate >= monthStart && endDate <= monthEnd) ||
                       (startDate <= monthStart && endDate >= monthEnd);
            });

            document.getElementById('totalActivities').textContent = monthActivities.length;
            
            const uniqueTeams = [...new Set(monthActivities.map(a => a.team))];
            document.getElementById('activeTeams').textContent = uniqueTeams.length;
            
            const today = new Date();
            const upcoming = monthActivities.filter(a => new Date(a.startDate) >= today);
            document.getElementById('upcomingActivities').textContent = upcoming.length;
        }

        function formatDateDisplay(dateStr) {
            const date = new Date(dateStr);
            const day = date.getDate();
            const monthNames = ["Jan", "Feb", "Mar", "Apr", "Mei", "Jun",
                              "Jul", "Agu", "Sep", "Okt", "Nov", "Des"];
            const month = monthNames[date.getMonth()];
            const year = date.getFullYear();
            return `${day} ${month} ${year}`;
        }

        // ========================================
        // CALENDAR NAVIGATION
        // ========================================
        
        function prevMonth() {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
            renderSamawaCalendar();
        }

        function nextMonth() {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
            renderSamawaCalendar();
        }

        function todayBtn() {
            currentCalendarDate = new Date();
            renderSamawaCalendar();
        }

        // ========================================
        // MODAL FUNCTIONS
        // ========================================
        
        function openAddModal() {
            document.getElementById('addModal').classList.add('active');
            document.getElementById('startDate').valueAsDate = new Date();
            document.getElementById('endDate').valueAsDate = new Date();
        }

        function closeAddModal() {
            document.getElementById('addModal').classList.remove('active');
            document.getElementById('addActivityForm').reset();
        }

        function openUploadModal() {
            document.getElementById('uploadModal').classList.add('active');
        }

        function closeUploadModal() {
            document.getElementById('uploadModal').classList.remove('active');
        }

        function closeDayModal() {
            document.getElementById('dayModal').classList.remove('active');
        }

        // ========================================
        // FORM HANDLERS
        // ========================================
        
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Calendar API Status
            updateCalendarAPIStatus();
            
            // Load activities and render calendar
            loadCalendarActivities().then(() => {
                renderSamawaCalendar();
            });

            // Add Activity Form
            const form = document.getElementById('addActivityForm');
            if (form) {
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const newActivity = {
                        team: document.getElementById('teamSelect').value,
                        name: document.getElementById('activityName').value,
                        startDate: document.getElementById('startDate').value,
                        endDate: document.getElementById('endDate').value
                    };

                    if (USE_CALENDAR_API && CALENDAR_API_URL) {
                        const saved = await saveToCalendarAPI(newActivity);
                        
                        if (saved) {
                            await loadCalendarActivities();
                            closeAddModal();
                            renderSamawaCalendar();
                            alert('‚úÖ Kegiatan berhasil ditambahkan ke Google Sheets!');
                        } else {
                            allActivities.push(newActivity);
                            saveToLocalStorage();
                            closeAddModal();
                            renderSamawaCalendar();
                            alert('‚ùå Gagal menyimpan ke Google Sheets. Tersimpan di browser saja.');
                        }
                    } else {
                        allActivities.push(newActivity);
                        saveToLocalStorage();
                        closeAddModal();
                        renderSamawaCalendar();
                        alert('‚úÖ Kegiatan berhasil ditambahkan!');
                    }
                });
            }

            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal-calendar')) {
                    event.target.classList.remove('active');
                }
            });
        });

        function updateCalendarAPIStatus() {
            const statusEl = document.getElementById('apiStatus');
            if (statusEl) {
                if (USE_GOOGLE_CALENDAR && GOOGLE_API_KEY !== 'AIzaSyDs6uykI_-bIYwUNGJdvKCtXKlUqVWDOQw') {
                    statusEl.innerHTML = 'üü¢ Connected to Google Calendar';
                    statusEl.style.color = '#10B981';
                } else {
                    statusEl.innerHTML = 'üü° Using Browser Storage (localStorage)';
                    statusEl.style.color = '#F59E0B';
                }
            }
        }

        // ========================================
        // EXCEL FUNCTIONS
        // ========================================
        
        function downloadTemplate() {
            const wb = XLSX.utils.book_new();
            const wsData = [
                ['Tim Kerja', 'Nama Kegiatan', 'Tanggal Mulai', 'Tanggal Selesai'],
                ['IPDS', 'Contoh Rapat Koordinasi', '2026-01-10', '2026-01-10'],
                ['Subbag Umum', 'Contoh Workshop', '2026-01-15', '2026-01-16'],
                ['', '', '', ''],
                ['CATATAN:', '', '', ''],
                ['1. Tim Kerja harus sesuai dengan daftar: Subbag Umum, Duknaker Kesra, Pertanian, Ekonomi, IPDS, UKK, Hansos & Analisis, Neraca, Harga, PSS RB', '', '', ''],
                ['2. Format tanggal: YYYY-MM-DD (contoh: 2026-01-10)', '', '', ''],
                ['3. Tanggal selesai harus >= tanggal mulai', '', '', '']
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            XLSX.utils.book_append_sheet(wb, ws, 'Template Kegiatan');
            XLSX.writeFile(wb, 'Template_Kegiatan_SAMAWA.xlsx');
        }

        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = async function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet);

                    let imported = 0;
                    let failed = 0;

                    for (const row of jsonData) {
                        if (row['Tim Kerja'] && row['Nama Kegiatan'] && 
                            row['Tanggal Mulai'] && row['Tanggal Selesai']) {
                            
                            const activity = {
                                team: row['Tim Kerja'],
                                name: row['Nama Kegiatan'],
                                startDate: row['Tanggal Mulai'],
                                endDate: row['Tanggal Selesai']
                            };

                            if (USE_CALENDAR_API && CALENDAR_API_URL) {
                                const saved = await saveToCalendarAPI(activity);
                                if (saved) {
                                    imported++;
                                } else {
                                    allActivities.push(activity);
                                    failed++;
                                }
                            } else {
                                allActivities.push(activity);
                                imported++;
                            }
                        }
                    }

                    if (USE_CALENDAR_API && CALENDAR_API_URL) {
                        await loadCalendarActivities();
                    } else {
                        saveToLocalStorage();
                    }

                    renderSamawaCalendar();
                    closeUploadModal();
                    
                    let message = `‚úÖ Berhasil import ${imported} kegiatan dari Excel!`;
                    if (failed > 0) {
                        message += `\n‚ö†Ô∏è ${failed} kegiatan gagal ke API, tersimpan di browser.`;
                    }
                    alert(message);
                } catch (error) {
                    alert('‚ùå Gagal membaca file Excel. Pastikan format sesuai template.');
                    console.error(error);
                }
            };
            reader.readAsArrayBuffer(file);
        }
    </script>
</body>
</html>
